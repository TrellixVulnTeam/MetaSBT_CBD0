if [ ! -z ${INDEX_HELP} ] && ${INDEX_HELP}; then
    echo "
NAME
    index -- Retrieve genomes from isolate sequencing from the NCBI GenBank and build a Sequence Bloom Tree for each species with kmtricks

VERSION
    "$VERSION" ("$DATE")

SYNOPSIS
    index [--db-dir=directory] [--kingdom=value] [--kmer-len=num] [--filter-size=num] [--how-many=num]
          [--estimate-filter-size] [--checkm-completeness=value] [--checkm-contamination=value] 
          [--dereplicate] [--nproc=num] [--xargs-nproc=num] [--tmp-dir=directory] [--cleanup] 
          [--increase-filter-size=num] ...

DESCRIPTION
    The \"index\" pipeline is used to automatically retrieve reference genomes and metagenome-assembled genomes from NCBI GenBank 
    and finally index them with kmtricks.

    The following options are available:

    --checkm-completeness=num
        Input genomes must have a minimum completeness percentage before being processed and added to the database
    
    --checkm-contamination=num
        Input genomes must have a maximum contamination percentage before being processed and added to the database

    --cleanup
        Remove temporary data at the end of the pipeline

    --db-dir=directory
        This is the database directory with the taxonomically organised sequence bloom trees

    --dereplicate
        Dereplicate input genomes based on the presence/absence of kmers

    --estimate-filter-size
        Automatically estimate the bloom filter size with ntCard

    --filter-size=num
        This is the size of the bloom filters

    -h|--help
        Print this help and exit
    
    --how-many=num
        Limit the number of genomes per species.
        The number of genomes per species is not limited by default

    --increase-filter-size=num
        Increase the estimated filter size by the specified percentage.
        This is used in conjunction with the --estimate-filter-size argument only.
        It is highly recommended to increase the filter size by a good percentage in case you are planning to update the index with new genomes.
        Default: --increase-filter-size=0
    
    --kingdom=value
        Consider genomes whose lineage belongs to a specific kingdom only

    --kmer-len=num
        This is the length of the kmers used for building bloom filters
    
    --nproc=num
        This argument refers to the number of processors used for parallelizing the pipeline when possible
        Default: --nproc=1

    --tmp-dir=directory
        Path to the folder for storing temporary data

    --xargs-nproc=num
        This refers to the number of xargs processes used for launching independent runs of kmtricks
        Default: --xargs-nproc=1

EXIT STATUS
    This script exits with one of the following values:

    0    The pipeline has been correctly applied.
    >0   An error occurred.

EXAMPLES
    Try running this script by typing:

        $ meta-index index --db-dir=~/myindex --kingdom=Bacteria --kmer-len=31 --estimate-filter-size 
                           --dereplicate --tmp-dir=~/tmp --nproc=4 --xargs-nproc=2 --cleanup
"
fi

if [ ! -z ${BOUNDARIES_HELP} ] && ${BOUNDARIES_HELP}; then
    echo "
NAME
    boundaries -- Define taxonomy-specific boundaries based on kmers for the definition of new clusters

VERSION
    "$VERSION" ("$DATE")

SYNOPSIS
    boundaries [--db-dir=directory] [--kingdom=value] [--min-genomes=num] 
               [--output=file] [--tmp-dir=directory] [--nproc=num] [--cleanup] ...

DESCRIPTION
    The \"boundaries\" module makes use of kmtricks to build a kmer matrix for each taxonomic level
    and define taxonomic-specific boundaries for the definition of new clusters.

    The following options are available:

    --cleanup
        Remove temporary data at the end of the pipeline

    --db-dir=directory
        This is the database directory with the taxonomically organised sequence bloom trees
    
    -h|--help
        Print this help and exit

    --kingdom=value
        Select a kingdom
    
    --min-genomes=num
        Consider clusters with at least this number of genomes
        Default: --min-genomes=100

    --nproc=num
        This argument refers to the number of processors used for parallelizing the pipeline when possible
        Default: --nproc=1

    --output=file
        Output file with kmer boundaries for each of the taxonomic labels in the database
    
    --tmp-dir=directory
        Path to the folder for storing temporary data
    
EXIT STATUS
    This script exits with one of the following values:

    0    The pipeline has been correctly applied.
    >0   An error occurred.

EXAMPLES
    Try running this script by typing:

        $ meta-index boundaries --db-dir=~/myindex --kingdom=Bacteria --min-genomes=100
                                --output=~/boundaries.txt --tmp-dir=~/tmp --nproc=4 --cleanup
"
fi

if [ ! -z ${UPDATE_HELP} ] && ${UPDATE_HELP}; then
    echo "
NAME
    update -- Update the database with new metagenome-assembled genomes and genomes from isolate sequencing

VERSION
    "$VERSION" ("$DATE")

SYNOPSIS
    update [--input-list=file] [--kmer-len=num] [--filter-size=num]
           [--checkm-completeness=num] [--checkm-contamination=num]
           [--db-dir=directory] [--tmp-dir=directory] [--dereplicate] 
           [--type=value] [--extension=value] [--taxa=file]
           [--kingdom=value] [--cleanup] [--nproc=num] ...

DESCRIPTION
    The \"update\" module is used to add new genomes to the database.

    The following options are available:

    --boundaries=file
        Path to the output table produced by the boundaries module.
        It is required in case of MAGs as input genomes only
    
    --boundary-uncertainty=num
        Define the percentage of kmers to enlarge and reduce boundaries
        Default: --boundary-uncertainty=0

    --checkm-completeness=num
        Input genomes must have a minimum completeness percentage before being processed and added to the database
    
    --checkm-contamination=num
        Input genomes must have a maximum contamination percentage before being processed and added to the database
    
    --cleanup
        Remove temporary data at the end of the pipeline
    
    --db-dir=directory
        This is the database directory with the taxonomically organised sequence bloom trees
    
    --dereplicate
        Dereplicate input genomes based on the presence/absence of kmers
    
    --extension=value
        Specify the input genome files extension.
        All the input genomes must have the same file extension before running this module

    --filter-size=num
        This is the size of the bloom filters.
        It must be the same size used while running the index module
    
    -h|--help
        Print this help and exit
    
    --input-list=file
        This file contains the list of paths to the new genomes that will be added to the database
    
    --kingdom=value
        Select the kingdom that will be updated

    --kmer-len=num
        This is the length of the kmers used for building bloom filters
        
    --nproc=num
        This argument refers to the number of processors used for parallelizing the pipeline when possible.
        Default: --nproc=1
        
    --tmp-dir=directory
        Path to the folder for storing temporary data
    
    --taxa=file
        Input file with the mapping between input genome IDs and their taxonomic label.
        This is used in case of reference genomes only \"--type=references\"

    --type=value
        Define the nature of the input genomes. Only \"references\" and \"MAGs\" are allowed
    
EXIT STATUS
    This script exits with one of the following values:

    0    The pipeline has been correctly applied.
    >0   An error occurred.
    
EXAMPLES
    Try running this script by typing:

        $ meta-index update --input-list=~/mygenomes.txt --db-dir=~/myindex --kingdom=Bacteria 
                            --tmp-dir=~/tmp --kmer-len=31 --filter-size=10000 --dereplicate 
                            --type=references --extension=fna.gz --nproc=8 --cleanup
"
fi

if [ ! -z ${PROFILE_HELP} ] && ${PROFILE_HELP}; then
    echo "
NAME
    profile -- Query the sequence bloom trees at all the 7 taxonomic levels

VERSION
    "$VERSION" ("$DATE")

SYNOPSIS
    profile [--input=file] [--tree=file] [--threshold=num]
            [--output-dir=directory] [--output-prefix=value] [--expand] ...

DESCRIPTION
    The \"profile\" module is used to query a sequence bloom tree at different taxonomic levels.

    The following options are available:

    --expand
        Expand the input query on all the taxonomic levels
        Default: false
    
    -h|--help
        Print this help and exit

    --input-file=file
        Path to the input genome
    
    --input-id=value
        Unique identifier of the input genome
        
    --output-dir=directory
        This is the output folder with queries results

    --output-prefix=value
        Prefix of the output files with query matches
    
    --threshold=num
        Fraction of query kmers that must be present in a leaf to be considered a match
        This must be between 0 and 1
        Default: 0.7

    --tree=file
        This is the tree definition file
    
EXIT STATUS
    This script exits with one of the following values:

    0    The pipeline has been correctly applied.
    >0   An error occurred.

EXAMPLES
    Try running this script by typing:

        $ meta-index profile --input-file=~/mymag.fna --input-id=mymag --tree=~/myindex/k__Bacteria/index.detbrief.sbt 
                             --threshold=0.7 --expand --output-dir=~/profiles --output-prefix=mymag
"
fi
